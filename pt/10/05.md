---
title: Arquivos de configura√ß√£o
actions: ['verificarResposta', 'dicas']
requireLogin: true
material:
  editor:
    language: javascript
    startingCode:
      "truffle.js": |

        //1. Inicialize `truffle-hdwallet-provider`

        // Defina seu pr√≥prio mnem√¥nico aqui
        const mnemonic = "YOUR_MNEMONIC";

        // Exporta√ß√µes de m√≥dulos para tornar esta configura√ß√£o dispon√≠vel para o pr√≥prio Truffle
        module.exports = {
          // Objeto com configura√ß√£o para cada rede
          networks: {
            // Configura√ß√£o para mainnet
            mainnet: {
              provider: function () {
                // Configurando o provedor com o endere√ßo Mainnet e Token da Infura
                return new HDWalletProvider(mnemonic, "https://mainnet.infura.io/v3/YOUR_TOKEN")
              },
              network_id: "1"
            },
            // Configura√ß√£o para rede rinkeby
            rinkeby: {
              // Fun√ß√£o especial para configurar o provedor
              provider: function () {
                // Configurando o provedor com o endere√ßo e token Infura Rinkeby
                return new HDWalletProvider(mnemonic, "https://rinkeby.infura.io/v3/YOUR_TOKEN")
              },
              network_id: //Preencha o `network_id` para a rede Rinkeby.
            }
          }
        };

    answer: |

      const HDWalletProvider = require("truffle-hdwallet-provider");

      // Defina seu pr√≥prio mnem√¥nico aqui
      const mnemonic = "YOUR_MNEMONIC";

      // Exporta√ß√µes de m√≥dulos para tornar esta configura√ß√£o dispon√≠vel para o pr√≥prio Truffle
      module.exports = {
        // Objeto com configura√ß√£o para cada rede
        networks: {
          // Configura√ß√£o para mainnet
          mainnet: {
            provider: function () {
              // Configurando o provedor com o endere√ßo Mainnet e Token da Infura
              return new HDWalletProvider(mnemonic, "https://mainnet.infura.io/v3/YOUR_TOKEN")
            },
            network_id: "1"
          },
          // Configura√ß√£o para rede rinkeby
          rinkeby: {
            // Fun√ß√£o especial para configurar o provedor
            provider: function () {
              // Configurando o provedor com o endere√ßo e token Infura Rinkeby
              return new HDWalletProvider(mnemonic, "https://rinkeby.infura.io/v3/YOUR_TOKEN")
            },
            // O ID da rede √© 4 para Rinkeby
            network_id: 4
          }
        }
      };
---

Incr√≠vel! Voc√™ compilou o c√≥digo-fonte com sucesso e criou um arquivo de migra√ß√£o.

Ainda h√° mais uma coisa a fazer antes de podermos implantar. Teremos que editar o arquivo de configura√ß√£o para informar ao **Truffle** as redes nas quais queremos implantar.

Espere um minuto, pensei que houvesse apenas uma rede **_Ethereum_**. O que estou esquecendo aqui?

## Redes de teste Ethereum

V√°rias redes de teste p√∫blicas **_Ethereum_** permitem que voc√™ teste seus contratos gratuitamente antes de implant√°-los na rede principal (lembre-se de que, depois que voc√™ implanta um contrato na rede principal, ele n√£o pode ser alterado). Essas redes de teste usam um algoritmo de consenso diferente da rede principal (geralmente PoA), e o Ether √© gratuito para incentivar testes completos.

Nesta li√ß√£o, usaremos Rinkeby, uma rede de teste p√∫blica criada pela The Ethereum Foundation.

## O arquivo de configura√ß√£o truffle.js

Agora, vamos dar uma olhada no arquivo de configura√ß√£o padr√£o **Truffle**:

```bash
$ cat truffle.js
/*
 * NB: since truffle-hdwallet-provider 0.0.5 you must wrap HDWallet providers in a
 * function when declaring them. Failure to do so will cause commands to hang. ex:
 *
 * mainnet: {
 *     provider: function() {
 *       return new HDWalletProvider(mnemonic, 'https://mainnet.infura.io/<infura-key>')
 *     },
 *     network_id: '1',
 *     gas: 4500000,
 *     gasPrice: 10000000000,
 *   },
 */
```

√â apenas um shell vazio. Portanto, seremos obrigados a atualizar este arquivo para nos permitir implementar contratos para Rinkeby e a mainnet Ethereum.

### Provedor de carteira HD da Truffle

Lembra do segundo cap√≠tulo?

Pedimos que voc√™ instalasse um pacote adicional chamado `truffle-hdwallet-provider` que ajuda a **Truffle** a assinar transa√ß√µes.

Agora, queremos editar nosso arquivo de configura√ß√£o para usar `HDWalletProvider`. Para que isso funcione, adicionaremos uma linha no topo do arquivo:

```JavaScript
const HDWalletProvider = require("truffle-hdwallet-provider");
```

Em seguida, criaremos uma nova vari√°vel para armazenar nosso mnem√¥nico:

```JavaScript
const mnemonic = "onions carrots beans ...";
```

Observe que n√£o recomendamos armazenar segredos como um mnem√¥nico ou uma chave privada em um arquivo de configura√ß√£o.

...mas por qu√™?

Arquivos de configura√ß√£o s√£o frequentemente enviados para o GitHub, onde qualquer um pode v√™-los, deixando voc√™ totalmente vulner√°vel a ataques üò±! Para evitar revelar seu mnem√¥nico (ou sua chave privada!), voc√™ deve l√™-lo de um arquivo e adicion√°-lo a `.gitignore`. Mostraremos como fazer isso mais tarde.

**Para manter as coisas simples neste caso**, copiamos o mnem√¥nico e o armazenamos em uma vari√°vel.

### Configurar Truffle para Rinkeby e rede principal Ethereum

Em seguida, para garantir que **Truffle** "saiba" as redes nas quais queremos implementar, teremos que criar dois objetos separados - um para Rinkeby e o outro para a rede principal **_Ethereum_**:

```JavaScript
networks: {
  // Configura√ß√£o para mainnet
  mainnet: {
    provider: function () {
      // Configurando o provedor com o endere√ßo Mainnet e Token da Infura
      return new HDWalletProvider(mnemonic, "https://mainnet.infura.io/v3/YOUR_TOKEN")
    },
    network_id: "1"
  },
  // Configura√ß√£o para rede rinkeby
  rinkeby: {
    // Fun√ß√£o especial para configurar o provedor
    provider: function () {
      // Configurando o provedor com o endere√ßo e token Infura Rinkeby
      return new HDWalletProvider(mnemonic, "https://rinkeby.infura.io/v3/YOUR_TOKEN")
    },
    // O ID da rede √© 4 para Rinkeby
    network_id: 4
  }
```

>Nota: o valor do provedor √© encapsulado em uma fun√ß√£o, o que garante que ele n√£o ser√° inicializado at√© que seja necess√°rio.

### Finalizando

Agora, vamos juntar essas pe√ßas e dar uma olhada em como nosso arquivo de configura√ß√£o deve ficar:

```JavaScript
// Inicialize HDWalletProvider
const HDWalletProvider = require("truffle-hdwallet-provider");

// Defina seu pr√≥prio mnem√¥nico aqui
const mnemonic = "YOUR_MNEMONIC";

// Exporta√ß√µes de m√≥dulos para tornar esta configura√ß√£o dispon√≠vel para o pr√≥prio Truffle
module.exports = {
  // Objetos com configura√ß√£o para cada rede
  networks: {
    // Configura√ß√£o para mainnet
    mainnet: {
      provider: function () {
        // Configurando o provedor com o endere√ßo Mainnet e Token da Infura
        return new HDWalletProvider(mnemonic, "https://mainnet.infura.io/v3/YOUR_TOKEN")
      },
      network_id: "1"
    },
    // Configura√ß√£o para rede rinkeby
    rinkeby: {
      // Fun√ß√£o especial para configurar o provedor
      provider: function () {
        // Configurando o provedor com o endere√ßo e token Infura Rinkeby
        return new HDWalletProvider(mnemonic, "https://rinkeby.infura.io/v3/YOUR_TOKEN")
      },
      // O ID da rede √© 4 para Rinkeby
      network_id: 4
    }
  }
};
```

# Vamos testar

N√≥s fomos em frente e atualizamos a maior parte do arquivo de configura√ß√£o para voc√™. Vamos preencher as partes que faltam:

1. No topo do arquivo, adicione a linha de c√≥digo que inicializa `truffle-hdwallet-provider`.

2. Preencha o `network_id` para a rede Rinkeby. Se voc√™ n√£o consegue lembrar o valor deste par√¢metro, verifique o trecho de c√≥digo acima.
